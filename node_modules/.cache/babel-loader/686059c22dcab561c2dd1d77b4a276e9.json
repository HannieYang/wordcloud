{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { isNil } from '@antv/util';\nimport GroupComponent from '../abstract/group-component';\nimport { getMatrixByAngle } from '../util/matrix';\nimport Theme from '../util/theme';\nimport { formatPadding } from '../util/util';\n\nvar CrosshairBase =\n/** @class */\nfunction (_super) {\n  __extends(CrosshairBase, _super);\n\n  function CrosshairBase() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  CrosshairBase.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n\n    return __assign(__assign({}, cfg), {\n      name: 'crosshair',\n      type: 'base',\n      line: {},\n      text: null,\n      textBackground: {},\n      capture: false,\n      defaultCfg: {\n        line: {\n          style: {\n            lineWidth: 1,\n            stroke: Theme.lineColor\n          }\n        },\n        text: {\n          position: 'start',\n          offset: 10,\n          autoRotate: false,\n          content: null,\n          style: {\n            fill: Theme.textColor,\n            textAlign: 'center',\n            textBaseline: 'middle',\n            fontFamily: Theme.fontFamily\n          }\n        },\n        textBackground: {\n          padding: 5,\n          style: {\n            stroke: Theme.lineColor\n          }\n        }\n      }\n    });\n  };\n\n  CrosshairBase.prototype.renderInner = function (group) {\n    if (this.get('line')) {\n      this.renderLine(group);\n    }\n\n    if (this.get('text')) {\n      this.renderText(group);\n      this.renderBackground(group);\n    }\n  };\n\n  CrosshairBase.prototype.renderText = function (group) {\n    var text = this.get('text');\n    var style = text.style,\n        autoRotate = text.autoRotate,\n        content = text.content;\n\n    if (!isNil(content)) {\n      var textPoint = this.getTextPoint();\n      var matrix = null;\n\n      if (autoRotate) {\n        var angle = this.getRotateAngle();\n        matrix = getMatrixByAngle(textPoint, angle);\n      }\n\n      this.addShape(group, {\n        type: 'text',\n        name: 'crosshair-text',\n        id: this.getElementId('text'),\n        attrs: __assign(__assign(__assign({}, textPoint), {\n          text: content,\n          matrix: matrix\n        }), style)\n      });\n    }\n  };\n\n  CrosshairBase.prototype.renderLine = function (group) {\n    var path = this.getLinePath();\n    var line = this.get('line');\n    var style = line.style;\n    this.addShape(group, {\n      type: 'path',\n      name: 'crosshair-line',\n      id: this.getElementId('line'),\n      attrs: __assign({\n        path: path\n      }, style)\n    });\n  }; // 绘制文本的背景\n\n\n  CrosshairBase.prototype.renderBackground = function (group) {\n    var textId = this.getElementId('text');\n    var textShape = group.findById(textId); // 查找文本\n\n    var textBackground = this.get('textBackground');\n\n    if (textBackground && textShape) {\n      var textBBox = textShape.getBBox();\n      var padding = formatPadding(textBackground.padding); // 用户传入的 padding 格式不定\n\n      var style = textBackground.style;\n      var backgroundShape = this.addShape(group, {\n        type: 'rect',\n        name: 'crosshair-text-background',\n        id: this.getElementId('text-background'),\n        attrs: __assign({\n          x: textBBox.x - padding[3],\n          y: textBBox.y - padding[0],\n          width: textBBox.width + padding[1] + padding[3],\n          height: textBBox.height + padding[0] + padding[2],\n          matrix: textShape.attr('matrix')\n        }, style)\n      });\n      backgroundShape.toBack();\n    }\n  };\n\n  return CrosshairBase;\n}(GroupComponent);\n\nexport default CrosshairBase;","map":{"version":3,"mappings":"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","names":["isNil","GroupComponent","getMatrixByAngle","Theme","formatPadding","__extends","CrosshairBase","cfg","_super","getDefaultCfg","call","name","type","line","text","textBackground","capture","defaultCfg","style","lineWidth","stroke","lineColor","position","offset","autoRotate","content","fill","textColor","textAlign","textBaseline","fontFamily","padding","group","get","renderLine","renderText","renderBackground","textPoint","getTextPoint","matrix","angle","getRotateAngle","addShape","id","getElementId","attrs","path","getLinePath","textId","textShape","findById","textBBox","getBBox","backgroundShape","x","y","width","height","attr","toBack"],"sourceRoot":"","sources":["../../src/crosshair/base.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}