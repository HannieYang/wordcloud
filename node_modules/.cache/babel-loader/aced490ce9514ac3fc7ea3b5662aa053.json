{"ast":null,"code":"var ELLIPSIS_CODE = '\\u2026';\n/** 获取字符串长度 */\n\nexport function strLen(str) {\n  var len = 0;\n\n  for (var i = 0; i < str.length; i++) {\n    len += charAtLength(str, i);\n  }\n\n  return len;\n}\n/** 是否属于ASCII编码范畴 */\n\nexport function charAtLength(str, i) {\n  if (str.charCodeAt(i) > 0 && str.charCodeAt(i) < 128) {\n    return 1;\n  } else {\n    return 2;\n  }\n}\n/** 文本省略 */\n\nexport function ellipsisString(str, reseveLength, position) {\n  if (position === void 0) {\n    position = 'tail';\n  }\n\n  var count = str.length;\n  var rst = '';\n\n  if (position === 'tail') {\n    for (var i = 0, index = 0; i < reseveLength;) {\n      var charLength = charAtLength(str, index);\n\n      if (i + charLength <= reseveLength) {\n        rst += str[index];\n        i += charAtLength(str, index);\n        index++;\n      } else {\n        break;\n      }\n    }\n\n    rst += ELLIPSIS_CODE;\n  } else if (position === 'head') {\n    for (var i = 0, index = count - 1; i < reseveLength;) {\n      var charLength = charAtLength(str, index);\n\n      if (i + charLength <= reseveLength) {\n        rst += str[index];\n        i += charAtLength(str, index);\n        index--;\n      } else {\n        break;\n      }\n    }\n\n    rst = ELLIPSIS_CODE + rst;\n  } else {\n    var startStr = '';\n    var endStr = '';\n\n    for (var i = 0, startIndex = 0, endIndex = count - 1; i < reseveLength;) {\n      var startCodeLen = charAtLength(str, startIndex);\n      var hasAdd = false; // 设置标志位，防止头尾都没有附加字符\n\n      if (startCodeLen + i <= reseveLength) {\n        startStr += str[startIndex];\n        startIndex++;\n        i += startCodeLen;\n        hasAdd = true;\n      }\n\n      var endCodeLen = charAtLength(str, endIndex);\n\n      if (endCodeLen + i <= reseveLength) {\n        endStr = str[endIndex] + endStr;\n        i += endCodeLen;\n        endIndex--;\n        hasAdd = true;\n      }\n\n      if (!hasAdd) {\n        // 如果都没有增加字符，说明都不适合则中断\n        break;\n      }\n    }\n\n    rst = startStr + ELLIPSIS_CODE + endStr;\n  }\n\n  return rst;\n}","map":{"version":3,"mappings":"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","names":["ELLIPSIS_CODE","strLen","str","len","i","length","charAtLength","charCodeAt","ellipsisString","reseveLength","position","count","rst","index","charLength","startStr","endStr","startIndex","endIndex","startCodeLen","hasAdd","endCodeLen"],"sourceRoot":"","sources":["../../src/util/text.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}