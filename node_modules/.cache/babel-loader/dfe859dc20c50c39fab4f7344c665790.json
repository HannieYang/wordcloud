{"ast":null,"code":"import { map, memoize, isString, each } from '@antv/util';\nvar RGB_REG = /rgba?\\(([\\s.,0-9]+)\\)/;\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^\\)]+\\))/gi;\n\nvar isGradientColor = function (val) {\n  return /^[r,R,L,l]{1}[\\s]*\\(/.test(val);\n}; // 创建辅助 tag 取颜色\n\n\nvar createTmp = function () {\n  var i = document.createElement('i');\n  i.title = 'Web Colour Picker';\n  i.style.display = 'none';\n  document.body.appendChild(i);\n  return i;\n}; // 获取颜色之间的插值\n\n\nvar getValue = function (start, end, percent, index) {\n  return start[index] + (end[index] - start[index]) * percent;\n}; // 数组转换成颜色\n\n\nfunction arr2rgb(arr) {\n  return \"#\" + toHex(arr[0]) + toHex(arr[1]) + toHex(arr[2]);\n} // rgb 颜色转换成数组\n\n\nvar rgb2arr = function (str) {\n  return [parseInt(str.substr(1, 2), 16), parseInt(str.substr(3, 2), 16), parseInt(str.substr(5, 2), 16)];\n}; // 将数值从 0-255 转换成16进制字符串\n\n\nvar toHex = function (value) {\n  var x16Value = Math.round(value).toString(16);\n  return x16Value.length === 1 ? \"0\" + x16Value : x16Value;\n}; // 计算颜色\n\n\nvar calColor = function (points, percent) {\n  var fixedPercent = isNaN(Number(percent)) || percent < 0 ? 0 : percent > 1 ? 1 : Number(percent);\n  var steps = points.length - 1;\n  var step = Math.floor(steps * fixedPercent);\n  var left = steps * fixedPercent - step;\n  var start = points[step];\n  var end = step === steps ? start : points[step + 1];\n  return arr2rgb([getValue(start, end, left, 0), getValue(start, end, left, 1), getValue(start, end, left, 2)]);\n}; // 用于给 toRGB 的缓存（使用 memoize 方法替换）\n// const colorCache = {};\n\n\nvar iEl;\n/**\n * 将颜色转换到 rgb 的格式\n * @param {color} color 颜色\n * @return 将颜色转换到 '#ffffff' 的格式\n */\n\nvar toRGB = function (color) {\n  // 如果已经是 rgb的格式\n  if (color[0] === '#' && color.length === 7) {\n    return color;\n  }\n\n  if (!iEl) {\n    // 防止防止在页头报错\n    iEl = createTmp();\n  }\n\n  iEl.style.color = color;\n  var rst = document.defaultView.getComputedStyle(iEl, '').getPropertyValue('color');\n  var matches = RGB_REG.exec(rst);\n  var cArray = matches[1].split(/\\s*,\\s*/).map(function (s) {\n    return Number(s);\n  });\n  rst = arr2rgb(cArray);\n  return rst;\n};\n/**\n * 获取渐变函数\n * @param colors 多个颜色\n * @return 颜色值\n */\n\n\nvar gradient = function (colors) {\n  var colorArray = isString(colors) ? colors.split('-') : colors;\n  var points = map(colorArray, function (color) {\n    return rgb2arr(color.indexOf('#') === -1 ? toRGB(color) : color);\n  }); // 返回一个函数\n\n  return function (percent) {\n    return calColor(points, percent);\n  };\n};\n\nvar toCSSGradient = function (gradientColor) {\n  if (isGradientColor(gradientColor)) {\n    var cssColor_1;\n    var steps = void 0;\n\n    if (gradientColor[0] === 'l') {\n      // 线性渐变\n      var arr = regexLG.exec(gradientColor);\n      var angle = +arr[1] + 90; // css 和 g 的渐变起始角度不同\n\n      steps = arr[2];\n      cssColor_1 = \"linear-gradient(\" + angle + \"deg, \";\n    } else if (gradientColor[0] === 'r') {\n      // 径向渐变\n      cssColor_1 = 'radial-gradient(';\n      var arr = regexRG.exec(gradientColor);\n      steps = arr[4];\n    }\n\n    var colorStops_1 = steps.match(regexColorStop);\n    each(colorStops_1, function (item, index) {\n      var itemArr = item.split(':');\n      cssColor_1 += itemArr[1] + \" \" + itemArr[0] * 100 + \"%\";\n\n      if (index !== colorStops_1.length - 1) {\n        cssColor_1 += ', ';\n      }\n    });\n    cssColor_1 += ')';\n    return cssColor_1;\n  }\n\n  return gradientColor;\n};\n\nexport default {\n  rgb2arr: rgb2arr,\n  gradient: gradient,\n  toRGB: memoize(toRGB),\n  toCSSGradient: toCSSGradient\n};","map":{"version":3,"mappings":"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","names":["map","memoize","isString","each","RGB_REG","regexLG","regexRG","regexColorStop","isGradientColor","val","test","createTmp","i","document","createElement","title","style","display","body","appendChild","getValue","start","end","percent","index","arr2rgb","arr","toHex","rgb2arr","str","parseInt","substr","value","x16Value","Math","round","toString","length","calColor","points","fixedPercent","isNaN","Number","steps","step","floor","left","iEl","toRGB","color","rst","defaultView","getComputedStyle","getPropertyValue","matches","exec","cArray","split","s","gradient","colors","colorArray","indexOf","toCSSGradient","gradientColor","cssColor_1","angle","colorStops_1","match","item","itemArr"],"sourceRoot":"","sources":["../src/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}