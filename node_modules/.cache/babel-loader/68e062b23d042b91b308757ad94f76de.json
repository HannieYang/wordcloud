{"ast":null,"code":"import { flow, deepAssign } from '../../../utils';\nimport { basicFunnel } from './basic';\n/**\n * 处理字段数据\n * @param params\n */\n\nfunction field(params) {\n  var _a;\n\n  var chart = params.chart,\n      options = params.options;\n  var _b = options.data,\n      data = _b === void 0 ? [] : _b,\n      yField = options.yField; // 绘制漏斗图\n\n  chart.data(data);\n  chart.scale((_a = {}, _a[yField] = {\n    sync: true\n  }, _a));\n  return params;\n}\n/**\n * geometry处理\n * @param params\n */\n\n\nfunction geometry(params) {\n  var chart = params.chart,\n      options = params.options;\n  var seriesField = options.seriesField,\n      isTransposed = options.isTransposed,\n      showFacetTitle = options.showFacetTitle;\n  chart.facet('rect', {\n    fields: [seriesField],\n    padding: [isTransposed ? 0 : 32, 10, 0, 10],\n    showTitle: showFacetTitle,\n    eachView: function (view, facet) {\n      basicFunnel(deepAssign({}, params, {\n        chart: view,\n        options: {\n          data: facet.data\n        }\n      }));\n    }\n  });\n  return params;\n}\n/**\n * 分面漏斗\n * @param chart\n * @param options\n */\n\n\nexport function facetFunnel(params) {\n  return flow(field, geometry)(params);\n}","map":{"version":3,"mappings":"AAAA,SAASA,IAAT,EAAeC,UAAf,QAAiC,gBAAjC;AAGA,SAASC,WAAT,QAA4B,SAA5B;AAEA;;;;;AAIA,SAASC,KAAT,CAAeC,MAAf,EAA4C;;;EAClC,SAAK,GAAcA,MAAM,MAAzB;EAAA,IAAOC,OAAO,GAAKD,MAAM,QAAzB;EACA,SAAsBC,OAAO,KAA7B;EAAA,QAAI,mBAAG,EAAH,GAAKC,EAAT;EAAA,IAAWC,MAAM,GAAKF,OAAO,OAA7B,CAFkC,CAG1C;;EACAG,KAAK,CAACC,IAAN,CAAWA,IAAX;EACAD,KAAK,CAACE,KAAN,EAAWC,SACTA,GAACJ,MAAD,IAAU;IACRK,IAAI,EAAE;EADE,CADD,IAAX;EAKA,OAAOR,MAAP;AACD;AAED;;;;;;AAIA,SAASS,QAAT,CAAkBT,MAAlB,EAA+C;EACrC,SAAK,GAAcA,MAAM,MAAzB;EAAA,IAAOC,OAAO,GAAKD,MAAM,QAAzB;EACA,eAAW,GAAmCC,OAAO,YAArD;EAAA,IAAaS,YAAY,GAAqBT,OAAO,aAArD;EAAA,IAA2BU,cAAc,GAAKV,OAAO,eAArD;EAERG,KAAK,CAACQ,KAAN,CAAY,MAAZ,EAAoB;IAClBC,MAAM,EAAE,CAACC,WAAD,CADU;IAElBC,OAAO,EAAE,CAACL,YAAY,GAAG,CAAH,GAAO,EAApB,EAAwB,EAAxB,EAA4B,CAA5B,EAA+B,EAA/B,CAFS;IAGlBM,SAAS,EAAEL,cAHO;IAIlBM,QAAQ,YAACC,IAAD,EAAON,KAAP,EAAY;MAClBd,WAAW,CACTD,UAAU,CAAC,EAAD,EAAKG,MAAL,EAAa;QACrBI,KAAK,EAAEc,IADc;QAErBjB,OAAO,EAAE;UACPI,IAAI,EAAEO,KAAK,CAACP;QADL;MAFY,CAAb,CADD,CAAX;IAQD;EAbiB,CAApB;EAgBA,OAAOL,MAAP;AACD;AAED;;;;;;;AAKA,OAAM,SAAUmB,WAAV,CAAsBnB,MAAtB,EAAmD;EACvD,OAAOJ,IAAI,CAACG,KAAD,EAAQU,QAAR,CAAJ,CAAsBT,MAAtB,CAAP;AACD","names":["flow","deepAssign","basicFunnel","field","params","options","_b","yField","chart","data","scale","_a","sync","geometry","isTransposed","showFacetTitle","facet","fields","seriesField","padding","showTitle","eachView","view","facetFunnel"],"sourceRoot":"","sources":["../../../../src/plots/funnel/geometries/facet.ts"],"sourcesContent":["import { flow, deepAssign } from '../../../utils';\nimport { Params } from '../../../core/adaptor';\nimport { FunnelOptions } from '../types';\nimport { basicFunnel } from './basic';\n\n/**\n * 处理字段数据\n * @param params\n */\nfunction field(params: Params<FunnelOptions>): Params<FunnelOptions> {\n  const { chart, options } = params;\n  const { data = [], yField } = options;\n  // 绘制漏斗图\n  chart.data(data);\n  chart.scale({\n    [yField]: {\n      sync: true,\n    },\n  });\n  return params;\n}\n\n/**\n * geometry处理\n * @param params\n */\nfunction geometry(params: Params<FunnelOptions>): Params<FunnelOptions> {\n  const { chart, options } = params;\n  const { seriesField, isTransposed, showFacetTitle } = options;\n\n  chart.facet('rect', {\n    fields: [seriesField],\n    padding: [isTransposed ? 0 : 32, 10, 0, 10],\n    showTitle: showFacetTitle,\n    eachView(view, facet) {\n      basicFunnel(\n        deepAssign({}, params, {\n          chart: view,\n          options: {\n            data: facet.data,\n          },\n        })\n      );\n    },\n  });\n\n  return params;\n}\n\n/**\n * 分面漏斗\n * @param chart\n * @param options\n */\nexport function facetFunnel(params: Params<FunnelOptions>) {\n  return flow(field, geometry)(params);\n}\n"]},"metadata":{},"sourceType":"module"}