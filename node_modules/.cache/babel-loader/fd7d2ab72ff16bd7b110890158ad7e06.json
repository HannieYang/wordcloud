{"ast":null,"code":"import { __assign, __extends, __rest } from \"tslib\";\nimport { clamp, deepMix, each, filter, get, mix, isNumber, isFunction } from '@antv/util';\nimport { ellipsisLabel } from '../util/label';\nimport { getMatrixByAngle, getMatrixByTranslate } from '../util/matrix';\nimport { getStatesStyle } from '../util/state';\nimport Theme from '../util/theme';\nimport LegendBase from './base';\n/**\n * 分页器 默认配置\n */\n\nvar DEFAULT_PAGE_NAVIGATOR = {\n  marker: {\n    style: {\n      inactiveFill: '#000',\n      inactiveOpacity: 0.45,\n      fill: '#000',\n      opacity: 1,\n      size: 12\n    }\n  },\n  text: {\n    style: {\n      fill: '#ccc',\n      fontSize: 12\n    }\n  }\n}; // 默认 文本style\n\nvar textStyle = {\n  fill: Theme.textColor,\n  fontSize: 12,\n  textAlign: 'start',\n  textBaseline: 'middle',\n  fontFamily: Theme.fontFamily,\n  fontWeight: 'normal',\n  lineHeight: 12\n};\nvar RIGHT_ARROW_NAME = 'navigation-arrow-right';\nvar LEFT_ARROW_NAME = 'navigation-arrow-left';\nvar ROTATE_MAP = {\n  right: 90 * Math.PI / 180,\n  left: (360 - 90) * Math.PI / 180,\n  up: 0,\n  down: 180 * Math.PI / 180\n};\n\nvar Category =\n/** @class */\nfunction (_super) {\n  __extends(Category, _super);\n\n  function Category() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.currentPageIndex = 1;\n    _this.totalPagesCnt = 1;\n    _this.pageWidth = 0;\n    _this.pageHeight = 0;\n    _this.startX = 0;\n    _this.startY = 0;\n\n    _this.onNavigationBack = function () {\n      var itemGroup = _this.getElementByLocalId('item-group');\n\n      if (_this.currentPageIndex > 1) {\n        _this.currentPageIndex -= 1;\n\n        _this.updateNavigation();\n\n        var matrix = _this.getCurrentNavigationMatrix();\n\n        if (_this.get('animate')) {\n          itemGroup.animate({\n            matrix: matrix\n          }, 100);\n        } else {\n          itemGroup.attr({\n            matrix: matrix\n          });\n        }\n      }\n    };\n\n    _this.onNavigationAfter = function () {\n      var itemGroup = _this.getElementByLocalId('item-group');\n\n      if (_this.currentPageIndex < _this.totalPagesCnt) {\n        _this.currentPageIndex += 1;\n\n        _this.updateNavigation();\n\n        var matrix = _this.getCurrentNavigationMatrix();\n\n        if (_this.get('animate')) {\n          itemGroup.animate({\n            matrix: matrix\n          }, 100);\n        } else {\n          itemGroup.attr({\n            matrix: matrix\n          });\n        }\n      }\n    };\n\n    return _this;\n  }\n\n  Category.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n\n    return __assign(__assign({}, cfg), {\n      name: 'legend',\n      type: 'category',\n      itemSpacing: 24,\n      itemMarginBottom: 8,\n      maxItemWidth: null,\n      itemWidth: null,\n      itemHeight: null,\n      itemName: {},\n      itemValue: null,\n      maxWidth: null,\n      maxHeight: null,\n      marker: {},\n      radio: null,\n      items: [],\n      itemStates: {},\n      itemBackground: {},\n      pageNavigator: {},\n      defaultCfg: {\n        title: {\n          spacing: 5,\n          style: {\n            fill: Theme.textColor,\n            fontSize: 12,\n            textAlign: 'start',\n            textBaseline: 'top'\n          }\n        },\n        background: {\n          padding: 5,\n          style: {\n            stroke: Theme.lineColor\n          }\n        },\n        itemBackground: {\n          style: {\n            opacity: 0,\n            fill: '#fff'\n          }\n        },\n        pageNavigator: DEFAULT_PAGE_NAVIGATOR,\n        itemName: {\n          spacing: 16,\n          style: textStyle\n        },\n        marker: {\n          spacing: 8,\n          style: {\n            r: 6,\n            symbol: 'circle'\n          }\n        },\n        itemValue: {\n          alignRight: false,\n          formatter: null,\n          style: textStyle,\n          spacing: 6\n        },\n        itemStates: {\n          active: {\n            nameStyle: {\n              opacity: 0.8\n            }\n          },\n          unchecked: {\n            nameStyle: {\n              fill: Theme.uncheckedColor\n            },\n            markerStyle: {\n              fill: Theme.uncheckedColor,\n              stroke: Theme.uncheckedColor\n            }\n          },\n          inactive: {\n            nameStyle: {\n              fill: Theme.uncheckedColor\n            },\n            markerStyle: {\n              opacity: 0.2\n            }\n          }\n        }\n      }\n    });\n  }; // 实现 IList 接口\n\n\n  Category.prototype.isList = function () {\n    return true;\n  };\n  /**\n   * 获取图例项\n   * @return {ListItem[]} 列表项集合\n   */\n\n\n  Category.prototype.getItems = function () {\n    return this.get('items');\n  };\n  /**\n   * 设置列表项\n   * @param {ListItem[]} items 列表项集合\n   */\n\n\n  Category.prototype.setItems = function (items) {\n    this.update({\n      items: items\n    });\n  };\n  /**\n   * 更新列表项\n   * @param {ListItem} item 列表项\n   * @param {object}   cfg  列表项\n   */\n\n\n  Category.prototype.updateItem = function (item, cfg) {\n    mix(item, cfg);\n    this.clear(); // 由于单个图例项变化，会引起全局变化，所以全部更新\n\n    this.render();\n  };\n  /**\n   * 清空列表\n   */\n\n\n  Category.prototype.clearItems = function () {\n    var itemGroup = this.getElementByLocalId('item-group');\n    itemGroup && itemGroup.clear();\n  };\n  /**\n   * 设置列表项的状态\n   * @param {ListItem} item  列表项\n   * @param {string}   state 状态名\n   * @param {boolean}  value 状态值, true, false\n   */\n\n\n  Category.prototype.setItemState = function (item, state, value) {\n    item[state] = value;\n    var itemElement = this.getElementByLocalId(\"item-\" + item.id);\n\n    if (itemElement) {\n      var items = this.getItems();\n      var index = items.indexOf(item);\n      var offsetGroup = this.createOffScreenGroup(); // 离屏的 group\n\n      var newElement = this.drawItem(item, index, this.getItemHeight(), offsetGroup);\n      this.updateElements(newElement, itemElement); // 更新整个分组\n\n      this.clearUpdateStatus(itemElement); // 清理更新状态，防止出现 bug\n    }\n  };\n  /**\n   * 是否存在指定的状态\n   * @param {ListItem} item  列表项\n   * @param {boolean} state 状态名\n   */\n\n\n  Category.prototype.hasState = function (item, state) {\n    return !!item[state];\n  };\n\n  Category.prototype.getItemStates = function (item) {\n    var itemStates = this.get('itemStates');\n    var rst = [];\n    each(itemStates, function (v, k) {\n      if (item[k]) {\n        // item.selected\n        rst.push(k);\n      }\n    });\n    return rst;\n  };\n  /**\n   * 清楚所有列表项的状态\n   * @param {string} state 状态值\n   */\n\n\n  Category.prototype.clearItemsState = function (state) {\n    var _this = this;\n\n    var items = this.getItemsByState(state);\n    each(items, function (item) {\n      _this.setItemState(item, state, false);\n    });\n  };\n  /**\n   * 根据状态获取图例项\n   * @param  {string}     state [description]\n   * @return {ListItem[]}       [description]\n   */\n\n\n  Category.prototype.getItemsByState = function (state) {\n    var _this = this;\n\n    var items = this.getItems();\n    return filter(items, function (item) {\n      return _this.hasState(item, state);\n    });\n  }; // 绘制 legend 的选项\n\n\n  Category.prototype.drawLegendContent = function (group) {\n    this.processItems();\n    this.drawItems(group);\n  }; // 防止未设置 id\n\n\n  Category.prototype.processItems = function () {\n    var items = this.get('items');\n    each(items, function (item) {\n      if (!item.id) {\n        // 如果没有设置 id，默认使用 name\n        item.id = item.name;\n      }\n    });\n  }; // 绘制所有的图例选项\n\n\n  Category.prototype.drawItems = function (group) {\n    var _this = this;\n\n    var itemContainerGroup = this.addGroup(group, {\n      id: this.getElementId('item-container-group'),\n      name: 'legend-item-container-group'\n    });\n    var itemGroup = this.addGroup(itemContainerGroup, {\n      id: this.getElementId('item-group'),\n      name: 'legend-item-group'\n    });\n    var itemHeight = this.getItemHeight();\n    var itemWidth = this.get('itemWidth');\n    var itemSpacing = this.get('itemSpacing');\n    var itemMarginBottom = this.get('itemMarginBottom');\n    var currentPoint = this.get('currentPoint');\n    var startX = currentPoint.x;\n    var startY = currentPoint.y;\n    var layout = this.get('layout');\n    var items = this.get('items');\n    var wrapped = false;\n    var pageWidth = 0;\n    var maxWidth = this.get('maxWidth'); // 最大宽度，会导致 layout : 'horizontal' 时自动换行\n\n    var maxHeight = this.get('maxHeight'); // 最大高度，会导致出现分页\n    // 暂时不考虑分页\n\n    each(items, function (item, index) {\n      var subGroup = _this.drawItem(item, index, itemHeight, itemGroup);\n\n      var bbox = subGroup.getBBox();\n      var width = itemWidth || bbox.width;\n\n      if (width > pageWidth) {\n        pageWidth = width;\n      }\n\n      if (layout === 'horizontal') {\n        // 如果水平布局\n        if (maxWidth && maxWidth < currentPoint.x + width - startX) {\n          // 检测是否换行\n          wrapped = true;\n          currentPoint.x = startX;\n          currentPoint.y += itemHeight + itemMarginBottom;\n        }\n\n        _this.moveElementTo(subGroup, currentPoint);\n\n        currentPoint.x += width + itemSpacing;\n      } else {\n        // 如果垂直布局\n        if (maxHeight && maxHeight < currentPoint.y + itemHeight + itemMarginBottom - startY) {\n          // 换行\n          wrapped = true;\n          currentPoint.x += pageWidth + itemSpacing;\n          currentPoint.y = startY;\n          pageWidth = 0;\n        }\n\n        _this.moveElementTo(subGroup, currentPoint);\n\n        currentPoint.y += itemHeight + itemMarginBottom; // itemSpacing 仅影响水平间距\n      }\n    });\n\n    if (wrapped && this.get('flipPage')) {\n      this.pageHeight = 0;\n      this.pageWidth = 0;\n      this.totalPagesCnt = 1;\n      this.startX = startX;\n      this.startY = startY;\n      this.adjustNavigation(group, itemGroup);\n    }\n  }; // 获取图例项的高度，如果未定义，则按照 name 的高度计算\n\n\n  Category.prototype.getItemHeight = function () {\n    var itemHeight = this.get('itemHeight');\n\n    if (!itemHeight) {\n      var style_1 = (this.get('itemName') || {}).style;\n\n      if (isFunction(style_1)) {\n        var items_1 = this.getItems();\n        items_1.forEach(function (item, index) {\n          var fontSize = __assign(__assign({}, textStyle), style_1(item, index, items_1)).fontSize;\n\n          if (itemHeight < fontSize) {\n            itemHeight = fontSize;\n          }\n        });\n      } else if (style_1) {\n        itemHeight = style_1.fontSize;\n      }\n    }\n\n    return itemHeight;\n  }; // 绘制 marker\n\n\n  Category.prototype.drawMarker = function (container, markerCfg, item, itemHeight) {\n    var markerAttrs = __assign(__assign(__assign({\n      x: 0,\n      y: itemHeight / 2\n    }, markerCfg.style), {\n      symbol: get(item.marker, 'symbol', 'circle')\n    }), get(item.marker, 'style', {}));\n\n    var shape = this.addShape(container, {\n      type: 'marker',\n      id: this.getElementId(\"item-\" + item.id + \"-marker\"),\n      name: 'legend-item-marker',\n      attrs: markerAttrs\n    });\n    var bbox = shape.getBBox();\n    shape.attr('x', bbox.width / 2); // marker 需要左对齐，所以不能占用左侧的空间\n\n    var _a = shape.attr(),\n        stroke = _a.stroke,\n        fill = _a.fill;\n\n    if (stroke) {\n      shape.set('isStroke', true);\n    }\n\n    if (fill) {\n      shape.set('isFill', true);\n    }\n\n    return shape;\n  }; // 绘制文本\n\n\n  Category.prototype.drawItemText = function (container, textName, cfg, item, itemHeight, xPosition, index) {\n    var formatter = cfg.formatter;\n    var style = cfg.style;\n\n    var attrs = __assign(__assign({\n      x: xPosition,\n      y: itemHeight / 2,\n      text: formatter ? formatter(item[textName], item, index) : item[textName]\n    }, textStyle), isFunction(style) ? style(item, index, this.getItems()) : style);\n\n    return this.addShape(container, {\n      type: 'text',\n      id: this.getElementId(\"item-\" + item.id + \"-\" + textName),\n      name: \"legend-item-\" + textName,\n      attrs: attrs\n    });\n  };\n\n  Category.prototype.drawRadio = function (container, radioCfg, item, itemHeight, x) {\n    var _a, _b;\n\n    var style = radioCfg.style || {}; // 以用户设置的 r 为主\n\n    var r = (_a = style.r) !== null && _a !== void 0 ? _a : itemHeight / 2;\n    var lineWidth = r * 3.6 / 8;\n    var _c = [x + r, itemHeight / 2 - r],\n        x0 = _c[0],\n        y0 = _c[1];\n    var _d = [x0 + r, y0 + r],\n        x1 = _d[0],\n        y1 = _d[1];\n    var _e = [x0, y1 + r],\n        x2 = _e[0],\n        y2 = _e[1];\n    var _f = [x, y0 + r],\n        x3 = _f[0],\n        y3 = _f[1];\n    var showRadio = item.showRadio;\n\n    var attrs = __assign(__assign({\n      path: [['M', x0, y0], ['A', r, r, 0, 0, 1, x1, y1], ['L', x1 - lineWidth, y1], ['L', x1, y1], ['A', r, r, 0, 0, 1, x2, y2], ['L', x2, y2 - lineWidth], ['L', x2, y2], ['A', r, r, 0, 0, 1, x3, y3], ['L', x3 + lineWidth, y3], ['L', x3, y3], ['A', r, r, 0, 0, 1, x0, y0], ['L', x0, y0 + lineWidth]],\n      stroke: '#000000',\n      fill: '#ffffff'\n    }, style), {\n      opacity: showRadio ? (_b = style === null || style === void 0 ? void 0 : style.opacity) !== null && _b !== void 0 ? _b : 0.45 : 0\n    });\n\n    var radioShape = this.addShape(container, {\n      type: 'path',\n      id: this.getElementId(\"item-\" + item.id + \"-radio\"),\n      name: 'legend-item-radio',\n      attrs: attrs\n    });\n    radioShape.set('tip', radioCfg.tip);\n    return radioShape;\n  }; // 绘制图例项\n\n\n  Category.prototype.drawItem = function (item, index, itemHeight, itemGroup) {\n    var groupId = \"item-\" + item.id; // 设置单独的 Group 用于 setClip\n\n    var subContainer = this.addGroup(itemGroup, {\n      name: 'legend-item-container',\n      id: this.getElementId(\"item-container-\" + groupId),\n      delegateObject: {\n        item: item,\n        index: index\n      }\n    });\n    var subGroup = this.addGroup(subContainer, {\n      name: 'legend-item',\n      id: this.getElementId(groupId),\n      delegateObject: {\n        item: item,\n        index: index\n      }\n    });\n    var marker = this.get('marker');\n    var itemName = this.get('itemName');\n    var itemValue = this.get('itemValue');\n    var itemBackground = this.get('itemBackground');\n    var radio = this.get('radio');\n    var itemWidth = this.getLimitItemWidth();\n    var curX = 0; // 记录当前 x 的位置\n\n    if (marker) {\n      var markerShape = this.drawMarker(subGroup, marker, item, itemHeight);\n      var spacing = marker.spacing;\n      var itemMarkerSpacing = get(item, ['marker', 'spacing']);\n\n      if (isNumber(itemMarkerSpacing)) {\n        // 如果 item 有配置 marker.spacing，采用 item 的配置\n        spacing = itemMarkerSpacing;\n      }\n\n      curX = markerShape.getBBox().maxX + spacing;\n    }\n\n    if (itemName) {\n      var nameShape = this.drawItemText(subGroup, 'name', itemName, item, itemHeight, curX, index);\n\n      if (itemWidth) {\n        // 设置了 item 的最大宽度限制，并且超出了，进行省略处理\n        ellipsisLabel(true, nameShape, clamp(itemWidth - curX, 0, itemWidth));\n      }\n\n      curX = nameShape.getBBox().maxX + itemName.spacing;\n    }\n\n    if (itemValue) {\n      var valueShape = this.drawItemText(subGroup, 'value', itemValue, item, itemHeight, curX, index);\n\n      if (itemWidth) {\n        if (itemValue.alignRight) {\n          valueShape.attr({\n            textAlign: 'right',\n            x: itemWidth\n          });\n          ellipsisLabel(true, valueShape, clamp(itemWidth - curX, 0, itemWidth), 'head');\n        } else {\n          ellipsisLabel(true, valueShape, clamp(itemWidth - curX, 0, itemWidth));\n        }\n      }\n\n      curX = valueShape.getBBox().maxX + itemValue.spacing;\n    }\n\n    if (radio) {\n      this.drawRadio(subGroup, radio, item, itemHeight, curX);\n    } // 添加透明的背景，便于拾取和包围盒计算\n\n\n    if (itemBackground) {\n      var bbox = subGroup.getBBox();\n      var backShape = this.addShape(subGroup, {\n        type: 'rect',\n        name: 'legend-item-background',\n        id: this.getElementId(groupId + \"-background\"),\n        attrs: __assign({\n          x: 0,\n          y: 0,\n          width: bbox.width,\n          height: itemHeight\n        }, itemBackground.style)\n      });\n      backShape.toBack();\n    }\n\n    this.applyItemStates(item, subGroup);\n    return subGroup;\n  }; // 加上分页器并重新排序 items\n\n\n  Category.prototype.adjustNavigation = function (container, itemGroup) {\n    var _this = this;\n\n    var startX = this.startX;\n    var startY = this.startY;\n    var layout = this.get('layout');\n    var subGroups = itemGroup.findAll(function (item) {\n      return item.get('name') === 'legend-item';\n    });\n    var maxWidth = this.get('maxWidth');\n    var maxHeight = this.get('maxHeight');\n    var itemWidth = this.get('itemWidth');\n    var itemSpacing = this.get('itemSpacing');\n    var itemHeight = this.getItemHeight();\n    var pageNavigator = deepMix({}, DEFAULT_PAGE_NAVIGATOR, this.get('pageNavigator'));\n    var navigation = this.drawNavigation(container, layout, '00/00', pageNavigator);\n    var navigationBBox = navigation.getBBox();\n    var currentPoint = {\n      x: startX,\n      y: startY\n    };\n    var pages = 1;\n    var widthLimit = 0;\n    var pageWidth = 0;\n    var maxItemWidth = 0;\n    var itemMarginBottom = this.get('itemMarginBottom');\n\n    if (layout === 'horizontal') {\n      var maxRow = this.get('maxRow') || 1;\n      var maxRowHeight_1 = itemHeight + (maxRow === 1 ? 0 : itemMarginBottom);\n      this.pageHeight = maxRowHeight_1 * maxRow;\n      each(subGroups, function (item) {\n        var bbox = item.getBBox();\n        var width = itemWidth || bbox.width;\n\n        if (widthLimit && widthLimit < currentPoint.x + width + itemSpacing || maxWidth < currentPoint.x + width + itemSpacing + navigationBBox.width) {\n          if (pages === 1) {\n            widthLimit = currentPoint.x + itemSpacing;\n            _this.pageWidth = widthLimit;\n\n            _this.moveElementTo(navigation, {\n              x: maxWidth - itemSpacing - navigationBBox.width - navigationBBox.minX,\n              y: currentPoint.y + itemHeight / 2 - navigationBBox.height / 2 - navigationBBox.minY\n            });\n          }\n\n          pages += 1;\n          currentPoint.x = startX;\n          currentPoint.y += maxRowHeight_1;\n        }\n\n        _this.moveElementTo(item, currentPoint);\n\n        item.getParent().setClip({\n          type: 'rect',\n          attrs: {\n            x: currentPoint.x,\n            y: currentPoint.y,\n            width: width + itemSpacing,\n            height: itemHeight\n          }\n        });\n        currentPoint.x += width + itemSpacing;\n      });\n    } else {\n      each(subGroups, function (item) {\n        var bbox = item.getBBox();\n\n        if (bbox.width > pageWidth) {\n          pageWidth = bbox.width;\n        }\n      });\n      maxItemWidth = pageWidth;\n      pageWidth += itemSpacing;\n\n      if (maxWidth) {\n        // maxWidth 限制加上\n        pageWidth = Math.min(maxWidth, pageWidth);\n        maxItemWidth = Math.min(maxWidth, maxItemWidth);\n      }\n\n      this.pageWidth = pageWidth;\n      this.pageHeight = maxHeight - Math.max(navigationBBox.height, itemHeight + itemMarginBottom);\n      var cntPerPage_1 = Math.floor(this.pageHeight / (itemHeight + itemMarginBottom));\n      each(subGroups, function (item, index) {\n        if (index !== 0 && index % cntPerPage_1 === 0) {\n          pages += 1;\n          currentPoint.x += pageWidth;\n          currentPoint.y = startY;\n        }\n\n        _this.moveElementTo(item, currentPoint);\n\n        item.getParent().setClip({\n          type: 'rect',\n          attrs: {\n            x: currentPoint.x,\n            y: currentPoint.y,\n            width: pageWidth,\n            height: itemHeight\n          }\n        });\n        currentPoint.y += itemHeight + itemMarginBottom;\n      });\n      this.totalPagesCnt = pages;\n      this.moveElementTo(navigation, {\n        x: startX + maxItemWidth / 2 - navigationBBox.width / 2 - navigationBBox.minX,\n        y: maxHeight - navigationBBox.height - navigationBBox.minY\n      });\n    }\n\n    if (this.pageHeight && this.pageWidth) {\n      // 为了使固定的 clip 生效，clip 设置在 itemContainerGroup 上，itemGroup 需要在翻页时会设置 matrix\n      itemGroup.getParent().setClip({\n        type: 'rect',\n        attrs: {\n          x: this.startX,\n          y: this.startY,\n          width: this.pageWidth,\n          height: this.pageHeight\n        }\n      });\n    } // 重新计算 totalPagesCnt\n\n\n    if (layout === 'horizontal' && this.get('maxRow')) {\n      this.totalPagesCnt = Math.ceil(pages / this.get('maxRow'));\n    } else {\n      this.totalPagesCnt = pages;\n    }\n\n    if (this.currentPageIndex > this.totalPagesCnt) {\n      this.currentPageIndex = 1;\n    }\n\n    this.updateNavigation(navigation); // update initial matrix\n\n    itemGroup.attr('matrix', this.getCurrentNavigationMatrix());\n  };\n  /**\n   * 绘制分页器\n   */\n\n\n  Category.prototype.drawNavigation = function (group, layout, text, styleCfg) {\n    var currentPoint = {\n      x: 0,\n      y: 0\n    };\n    var subGroup = this.addGroup(group, {\n      id: this.getElementId('navigation-group'),\n      name: 'legend-navigation'\n    });\n\n    var _a = get(styleCfg.marker, 'style', {}),\n        _b = _a.size,\n        size = _b === void 0 ? 12 : _b,\n        arrowStyle = __rest(_a, [\"size\"]);\n\n    var leftArrow = this.drawArrow(subGroup, currentPoint, LEFT_ARROW_NAME, layout === 'horizontal' ? 'up' : 'left', size, arrowStyle);\n    leftArrow.on('click', this.onNavigationBack);\n    var leftArrowBBox = leftArrow.getBBox();\n    currentPoint.x += leftArrowBBox.width + 2;\n    var textShape = this.addShape(subGroup, {\n      type: 'text',\n      id: this.getElementId('navigation-text'),\n      name: 'navigation-text',\n      attrs: __assign({\n        x: currentPoint.x,\n        y: currentPoint.y + size / 2,\n        text: text,\n        textBaseline: 'middle'\n      }, get(styleCfg.text, 'style'))\n    });\n    var textBBox = textShape.getBBox();\n    currentPoint.x += textBBox.width + 2;\n    var rightArrow = this.drawArrow(subGroup, currentPoint, RIGHT_ARROW_NAME, layout === 'horizontal' ? 'down' : 'right', size, arrowStyle);\n    rightArrow.on('click', this.onNavigationAfter);\n    return subGroup;\n  };\n\n  Category.prototype.updateNavigation = function (navigation) {\n    var pageNavigator = deepMix({}, DEFAULT_PAGE_NAVIGATOR, this.get('pageNavigator'));\n    var _a = pageNavigator.marker.style,\n        fill = _a.fill,\n        opacity = _a.opacity,\n        inactiveFill = _a.inactiveFill,\n        inactiveOpacity = _a.inactiveOpacity;\n    var text = this.currentPageIndex + \"/\" + this.totalPagesCnt;\n    var textShape = navigation ? navigation.getChildren()[1] : this.getElementByLocalId('navigation-text');\n    var leftArrow = navigation ? navigation.findById(this.getElementId(LEFT_ARROW_NAME)) : this.getElementByLocalId(LEFT_ARROW_NAME);\n    var rightArrow = navigation ? navigation.findById(this.getElementId(RIGHT_ARROW_NAME)) : this.getElementByLocalId(RIGHT_ARROW_NAME);\n    textShape.attr('text', text); // 更新 left-arrow marker\n\n    leftArrow.attr('opacity', this.currentPageIndex === 1 ? inactiveOpacity : opacity);\n    leftArrow.attr('fill', this.currentPageIndex === 1 ? inactiveFill : fill);\n    leftArrow.attr('cursor', this.currentPageIndex === 1 ? 'not-allowed' : 'pointer'); // 更新 right-arrow marker\n\n    rightArrow.attr('opacity', this.currentPageIndex === this.totalPagesCnt ? inactiveOpacity : opacity);\n    rightArrow.attr('fill', this.currentPageIndex === this.totalPagesCnt ? inactiveFill : fill);\n    rightArrow.attr('cursor', this.currentPageIndex === this.totalPagesCnt ? 'not-allowed' : 'pointer'); // 更新位置\n\n    var cursorX = leftArrow.getBBox().maxX + 2;\n    textShape.attr('x', cursorX);\n    cursorX += textShape.getBBox().width + 2;\n    this.updateArrowPath(rightArrow, {\n      x: cursorX,\n      y: 0\n    });\n  };\n\n  Category.prototype.drawArrow = function (group, currentPoint, name, direction, size, style) {\n    var x = currentPoint.x,\n        y = currentPoint.y;\n    var shape = this.addShape(group, {\n      type: 'path',\n      id: this.getElementId(name),\n      name: name,\n      attrs: __assign({\n        size: size,\n        direction: direction,\n        path: [['M', x + size / 2, y], ['L', x, y + size], ['L', x + size, y + size], ['Z']],\n        cursor: 'pointer'\n      }, style)\n    });\n    shape.attr('matrix', getMatrixByAngle({\n      x: x + size / 2,\n      y: y + size / 2\n    }, ROTATE_MAP[direction]));\n    return shape;\n  };\n  /**\n   * 更新分页器 arrow 组件\n   */\n\n\n  Category.prototype.updateArrowPath = function (arrow, point) {\n    var x = point.x,\n        y = point.y;\n\n    var _a = arrow.attr(),\n        size = _a.size,\n        direction = _a.direction;\n\n    var matrix = getMatrixByAngle({\n      x: x + size / 2,\n      y: y + size / 2\n    }, ROTATE_MAP[direction]);\n    arrow.attr('path', [['M', x + size / 2, y], ['L', x, y + size], ['L', x + size, y + size], ['Z']]);\n    arrow.attr('matrix', matrix);\n  };\n\n  Category.prototype.getCurrentNavigationMatrix = function () {\n    var _a = this,\n        currentPageIndex = _a.currentPageIndex,\n        pageWidth = _a.pageWidth,\n        pageHeight = _a.pageHeight;\n\n    var layout = this.get('layout');\n    var translate = layout === 'horizontal' ? {\n      x: 0,\n      y: pageHeight * (1 - currentPageIndex)\n    } : {\n      x: pageWidth * (1 - currentPageIndex),\n      y: 0\n    };\n    return getMatrixByTranslate(translate);\n  }; // 附加状态对应的样式\n\n\n  Category.prototype.applyItemStates = function (item, subGroup) {\n    var states = this.getItemStates(item);\n    var hasStates = states.length > 0;\n\n    if (hasStates) {\n      var children = subGroup.getChildren();\n      var itemStates_1 = this.get('itemStates');\n      each(children, function (element) {\n        var name = element.get('name');\n        var elName = name.split('-')[2]; // marker, name, value\n\n        var statesStyle = getStatesStyle(item, elName, itemStates_1);\n\n        if (statesStyle) {\n          element.attr(statesStyle);\n\n          if (elName === 'marker' && !(element.get('isStroke') && element.get('isFill'))) {\n            // 如果 marker 是单填充或者单描边的话，就不要额外添加 stroke 或这 fill 属性，否则会影响 unchecked 后的显示\n            if (element.get('isStroke')) {\n              element.attr('fill', null);\n            }\n\n            if (element.get('isFill')) {\n              element.attr('stroke', null);\n            }\n          }\n        }\n      });\n    }\n  }; // 获取 itemWidth 的最终设置\n\n\n  Category.prototype.getLimitItemWidth = function () {\n    var itemWidth = this.get('itemWidth');\n    var maxItemWidth = this.get('maxItemWidth');\n\n    if (maxItemWidth) {\n      // 设置了最大宽度\n      if (itemWidth) {\n        maxItemWidth = itemWidth <= maxItemWidth ? itemWidth : maxItemWidth;\n      }\n    } else if (itemWidth) {\n      maxItemWidth = itemWidth;\n    }\n\n    return maxItemWidth;\n  };\n\n  return Category;\n}(LegendBase);\n\nexport default Category;","map":{"version":3,"mappings":"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","names":["clamp","deepMix","each","filter","get","mix","isNumber","isFunction","ellipsisLabel","getMatrixByAngle","getMatrixByTranslate","getStatesStyle","Theme","LegendBase","DEFAULT_PAGE_NAVIGATOR","marker","style","inactiveFill","inactiveOpacity","fill","opacity","size","text","fontSize","textStyle","textColor","textAlign","textBaseline","fontFamily","fontWeight","lineHeight","RIGHT_ARROW_NAME","LEFT_ARROW_NAME","ROTATE_MAP","right","Math","PI","left","up","down","__extends","_this","itemGroup","getElementByLocalId","currentPageIndex","updateNavigation","matrix","getCurrentNavigationMatrix","animate","attr","totalPagesCnt","Category","cfg","_super","getDefaultCfg","call","name","type","itemSpacing","itemMarginBottom","maxItemWidth","itemWidth","itemHeight","itemName","itemValue","maxWidth","maxHeight","radio","items","itemStates","itemBackground","pageNavigator","defaultCfg","title","spacing","background","padding","stroke","lineColor","r","symbol","alignRight","formatter","active","nameStyle","unchecked","uncheckedColor","markerStyle","inactive","update","item","clear","render","state","value","itemElement","id","getItems","index","indexOf","offsetGroup","createOffScreenGroup","newElement","drawItem","getItemHeight","updateElements","clearUpdateStatus","rst","v","k","push","getItemsByState","setItemState","hasState","group","processItems","drawItems","itemContainerGroup","addGroup","getElementId","currentPoint","startX","x","startY","y","layout","wrapped","pageWidth","subGroup","bbox","getBBox","width","moveElementTo","pageHeight","adjustNavigation","style_1","items_1","forEach","container","markerCfg","markerAttrs","shape","addShape","attrs","set","textName","xPosition","radioCfg","_a","lineWidth","x0","y0","x1","y1","x2","y2","x3","y3","path","showRadio","_b","radioShape","tip","groupId","subContainer","delegateObject","getLimitItemWidth","curX","markerShape","drawMarker","itemMarkerSpacing","maxX","nameShape","drawItemText","valueShape","drawRadio","backShape","height","toBack","applyItemStates","subGroups","findAll","navigation","drawNavigation","navigationBBox","pages","widthLimit","maxRow","maxRowHeight_1","minX","minY","getParent","setClip","min","max","cntPerPage_1","floor","ceil","styleCfg","arrowStyle","leftArrow","drawArrow","on","onNavigationBack","leftArrowBBox","textShape","textBBox","rightArrow","onNavigationAfter","getChildren","findById","cursorX","updateArrowPath","direction","cursor","arrow","point","translate","states","getItemStates","hasStates","length","children","itemStates_1","element","elName","split","statesStyle"],"sourceRoot":"","sources":["../../src/legend/category.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}