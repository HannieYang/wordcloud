{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport GroupComponent from '../abstract/group-component';\nimport { createBBox, formatPadding } from '../util/util';\n\nvar LegendBase =\n/** @class */\nfunction (_super) {\n  __extends(LegendBase, _super);\n\n  function LegendBase() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  LegendBase.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n\n    return __assign(__assign({}, cfg), {\n      name: 'legend',\n\n      /**\n       * 布局方式： horizontal，vertical\n       * @type {String}\n       */\n      layout: 'horizontal',\n      locationType: 'point',\n      x: 0,\n      y: 0,\n      offsetX: 0,\n      offsetY: 0,\n      title: null,\n      background: null\n    });\n  };\n\n  LegendBase.prototype.getLayoutBBox = function () {\n    var bbox = _super.prototype.getLayoutBBox.call(this);\n\n    var maxWidth = this.get('maxWidth');\n    var maxHeight = this.get('maxHeight');\n    var width = bbox.width,\n        height = bbox.height;\n\n    if (maxWidth) {\n      width = Math.min(width, maxWidth);\n    }\n\n    if (maxHeight) {\n      height = Math.min(height, maxHeight);\n    }\n\n    return createBBox(bbox.minX, bbox.minY, width, height);\n  };\n\n  LegendBase.prototype.setLocation = function (cfg) {\n    this.set('x', cfg.x);\n    this.set('y', cfg.y);\n    this.resetLocation();\n  };\n\n  LegendBase.prototype.resetLocation = function () {\n    var x = this.get('x');\n    var y = this.get('y');\n    var offsetX = this.get('offsetX');\n    var offsetY = this.get('offsetY');\n    this.moveElementTo(this.get('group'), {\n      x: x + offsetX,\n      y: y + offsetY\n    });\n  };\n\n  LegendBase.prototype.applyOffset = function () {\n    this.resetLocation();\n  }; // 获取当前绘制的点\n\n\n  LegendBase.prototype.getDrawPoint = function () {\n    return this.get('currentPoint');\n  };\n\n  LegendBase.prototype.setDrawPoint = function (point) {\n    return this.set('currentPoint', point);\n  }; // 复写父类定义的绘制方法\n\n\n  LegendBase.prototype.renderInner = function (group) {\n    this.resetDraw();\n\n    if (this.get('title')) {\n      this.drawTitle(group);\n    }\n\n    this.drawLegendContent(group);\n\n    if (this.get('background')) {\n      this.drawBackground(group);\n    } // this.resetLocation(); // 在顶层已经在处理偏移时一起处理了\n\n  }; // 绘制背景\n\n\n  LegendBase.prototype.drawBackground = function (group) {\n    var background = this.get('background');\n    var bbox = group.getBBox();\n    var padding = formatPadding(background.padding);\n\n    var attrs = __assign({\n      // 背景从 (0,0) 开始绘制\n      x: 0,\n      y: 0,\n      width: bbox.width + padding[1] + padding[3],\n      height: bbox.height + padding[0] + padding[2]\n    }, background.style);\n\n    var backgroundShape = this.addShape(group, {\n      type: 'rect',\n      id: this.getElementId('background'),\n      name: 'legend-background',\n      attrs: attrs\n    });\n    backgroundShape.toBack();\n  }; // 绘制标题，标题在图例项的上面\n\n\n  LegendBase.prototype.drawTitle = function (group) {\n    var currentPoint = this.get('currentPoint');\n    var titleCfg = this.get('title');\n    var spacing = titleCfg.spacing,\n        style = titleCfg.style,\n        text = titleCfg.text;\n    var shape = this.addShape(group, {\n      type: 'text',\n      id: this.getElementId('title'),\n      name: 'legend-title',\n      attrs: __assign({\n        text: text,\n        x: currentPoint.x,\n        y: currentPoint.y\n      }, style)\n    });\n    var bbox = shape.getBBox(); // 标题单独在一行\n\n    this.set('currentPoint', {\n      x: currentPoint.x,\n      y: bbox.maxY + spacing\n    });\n  }; // 重置绘制时开始的位置，如果绘制边框，考虑边框的 padding\n\n\n  LegendBase.prototype.resetDraw = function () {\n    var background = this.get('background');\n    var currentPoint = {\n      x: 0,\n      y: 0\n    };\n\n    if (background) {\n      var padding = formatPadding(background.padding);\n      currentPoint.x = padding[3]; // 左边 padding\n\n      currentPoint.y = padding[0]; // 上面 padding\n    }\n\n    this.set('currentPoint', currentPoint); // 设置绘制的初始位置\n  };\n\n  return LegendBase;\n}(GroupComponent);\n\nexport default LegendBase;","map":{"version":3,"mappings":"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","names":["GroupComponent","createBBox","formatPadding","__extends","LegendBase","cfg","_super","getDefaultCfg","call","name","layout","locationType","x","y","offsetX","offsetY","title","background","bbox","getLayoutBBox","maxWidth","get","maxHeight","height","width","Math","min","minX","minY","set","resetLocation","moveElementTo","point","group","resetDraw","drawTitle","drawLegendContent","drawBackground","getBBox","padding","attrs","style","backgroundShape","addShape","type","id","getElementId","toBack","currentPoint","titleCfg","text","shape","maxY","spacing"],"sourceRoot":"","sources":["../../src/legend/base.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}