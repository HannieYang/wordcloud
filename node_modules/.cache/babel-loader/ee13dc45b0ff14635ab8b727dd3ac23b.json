{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport * as _ from '@antv/util';\nimport Adjust from './adjust';\n\nvar Symmetric =\n/** @class */\nfunction (_super) {\n  __extends(Symmetric, _super);\n\n  function Symmetric() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Symmetric.prototype.process = function (groupDataArray) {\n    var mergeData = _.flatten(groupDataArray);\n\n    var _a = this,\n        xField = _a.xField,\n        yField = _a.yField; // 每个 x 值对应的 最大值\n\n\n    var cache = this.getXValuesMaxMap(mergeData); // 所有数据的最大的值\n\n    var max = Math.max.apply(Math, Object.keys(cache).map(function (key) {\n      return cache[key];\n    }));\n    return _.map(groupDataArray, function (dataArray) {\n      return _.map(dataArray, function (data) {\n        var _a, _b;\n\n        var yValue = data[yField];\n        var xValue = data[xField]; // 数组处理逻辑\n\n        if (_.isArray(yValue)) {\n          var off_1 = (max - cache[xValue]) / 2;\n          return __assign(__assign({}, data), (_a = {}, _a[yField] = _.map(yValue, function (y) {\n            return off_1 + y;\n          }), _a));\n        } // 非数组处理逻辑\n\n\n        var offset = (max - yValue) / 2;\n        return __assign(__assign({}, data), (_b = {}, _b[yField] = [offset, yValue + offset], _b));\n      });\n    });\n  }; // 获取每个 x 对应的最大的值\n\n\n  Symmetric.prototype.getXValuesMaxMap = function (mergeData) {\n    var _this = this;\n\n    var _a = this,\n        xField = _a.xField,\n        yField = _a.yField; // 根据 xField 的值进行分组\n\n\n    var groupDataArray = _.groupBy(mergeData, function (data) {\n      return data[xField];\n    }); // 获取每个 xField 值中的最大值\n\n\n    return _.mapValues(groupDataArray, function (dataArray) {\n      return _this.getDimMaxValue(dataArray, yField);\n    });\n  };\n\n  Symmetric.prototype.getDimMaxValue = function (mergeData, dim) {\n    // 所有的 value 值\n    var dimValues = _.map(mergeData, function (data) {\n      return _.get(data, dim, []);\n    }); // 将数组打平（dim value 有可能是数组，比如 stack 之后的）\n\n\n    var flattenValues = _.flatten(dimValues); // 求出数组的最大值\n\n\n    return Math.max.apply(Math, flattenValues);\n  };\n\n  return Symmetric;\n}(Adjust);\n\nexport default Symmetric;","map":{"version":3,"mappings":";AAAA,OAAO,KAAKA,CAAZ,MAAmB,YAAnB;AAEA,OAAOC,MAAP,MAAmB,UAAnB;;AAEA;AAAA;AAAA;EAAuCC;;EAAvC;;EAyDC;;EAxDQC,8BAAP,UAAeC,cAAf,EAAuC;IACrC,IAAMC,SAAS,GAAGL,CAAC,CAACM,OAAF,CAAUF,cAAV,CAAlB;;IAEM,SAAqB,IAArB;IAAA,IAAEG,MAAM,YAAR;IAAA,IAAUC,MAAM,YAAhB,CAH+B,CAKrC;;;IACA,IAAMC,KAAK,GAAG,KAAKC,gBAAL,CAAsBL,SAAtB,CAAd,CANqC,CAQrC;;IACA,IAAMM,GAAG,GAAGC,IAAI,CAACD,GAAL,CAAQE,KAAR,OAAYC,MAAM,CAACC,IAAP,CAAYN,KAAZ,EAAmBO,GAAnB,CAAuB,UAACC,GAAD,EAAI;MAAK,YAAK,CAACA,GAAD,CAAL;IAAU,CAA1C,CAAZ,CAAZ;IAEA,OAAOjB,CAAC,CAACgB,GAAF,CAAMZ,cAAN,EAAsB,UAACc,SAAD,EAAU;MACrC,OAAOlB,CAAC,CAACgB,GAAF,CAAME,SAAN,EAAiB,UAACC,IAAD,EAAK;;;QAC3B,IAAMC,MAAM,GAAGD,IAAI,CAACX,MAAD,CAAnB;QACA,IAAMa,MAAM,GAAGF,IAAI,CAACZ,MAAD,CAAnB,CAF2B,CAI3B;;QACA,IAAIP,CAAC,CAACsB,OAAF,CAAUF,MAAV,CAAJ,EAAuB;UACrB,IAAMG,KAAG,GAAG,CAACZ,GAAG,GAAGF,KAAK,CAACY,MAAD,CAAZ,IAAwB,CAApC;UAEA,6BACKF,IADL,IACSK,YACNhB,MADM,IACGR,CAAC,CAACgB,GAAF,CAAMI,MAAN,EAAc,UAACK,CAAD,EAAU;YAAK,YAAG,GAAGA,CAAN;UAAO,CAApC,CADH,EACwCD,EAFjD;QAID,CAZ0B,CAc3B;;;QACA,IAAME,MAAM,GAAG,CAACf,GAAG,GAAGS,MAAP,IAAiB,CAAhC;QACA,6BACKD,IADL,IACSQ,YACNnB,MADM,IACG,CAACkB,MAAD,EAASN,MAAM,GAAGM,MAAlB,CADH,EAC4BC,EAFrC;MAID,CApBM,CAAP;IAqBD,CAtBM,CAAP;EAuBD,CAlCM,CADT,CAqCE;;;EACQxB,uCAAR,UAAyBE,SAAzB,EAA0C;IAA1C;;IACQ,SAAqB,IAArB;IAAA,IAAEE,MAAM,YAAR;IAAA,IAAUC,MAAM,YAAhB,CADkC,CAGxC;;;IACA,IAAMJ,cAAc,GAAGJ,CAAC,CAAC4B,OAAF,CAAUvB,SAAV,EAAqB,UAACc,IAAD,EAAK;MAAK,WAAI,CAACZ,MAAD,CAAJ;IAAsB,CAArD,CAAvB,CAJwC,CAMxC;;;IACA,OAAOP,CAAC,CAAC6B,SAAF,CAAYzB,cAAZ,EAA4B,UAACc,SAAD,EAAU;MAAK,YAAI,CAACY,cAAL,CAAoBZ,SAApB,EAA+BV,MAA/B;IAAsC,CAAjF,CAAP;EACD,CARO;;EAUAL,qCAAR,UAAuBE,SAAvB,EAA0C0B,GAA1C,EAAqD;IACnD;IACA,IAAMC,SAAS,GAAGhC,CAAC,CAACgB,GAAF,CAAMX,SAAN,EAAiB,UAACc,IAAD,EAAK;MAAK,QAAC,CAACc,GAAF,CAAMd,IAAN,EAAYY,GAAZ,EAAiB,EAAjB;IAAoB,CAA/C,CAAlB,CAFmD,CAGnD;;;IACA,IAAMG,aAAa,GAAGlC,CAAC,CAACM,OAAF,CAAU0B,SAAV,CAAtB,CAJmD,CAMnD;;;IACA,OAAOpB,IAAI,CAACD,GAAL,CAAQE,KAAR,OAAYqB,aAAZ,CAAP;EACD,CARO;;EASV;AAAC,CAzDD,CAAuCjC,MAAvC","names":["_","Adjust","__extends","Symmetric","groupDataArray","mergeData","flatten","xField","yField","cache","getXValuesMaxMap","max","Math","apply","Object","keys","map","key","dataArray","data","yValue","xValue","isArray","off_1","_a","y","offset","_b","groupBy","mapValues","getDimMaxValue","dim","dimValues","get","flattenValues"],"sourceRoot":"","sources":["../../src/adjusts/symmetric.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}