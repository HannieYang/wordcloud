{"ast":null,"code":"import { each } from '@antv/util';\nimport { translate } from '../../../util/transform';\n/**\n * @ignore\n * 将 label 限制在画布范围内，简单得将超出画布的 label 往画布内调整\n * @param labels\n * @param cfg\n */\n\nexport function limitInCanvas(items, labels, shapes, region) {\n  each(labels, function (label) {\n    var regionMinX = region.minX,\n        regionMinY = region.minY,\n        regionMaxX = region.maxX,\n        regionMaxY = region.maxY;\n\n    var _a = label.getCanvasBBox(),\n        minX = _a.minX,\n        minY = _a.minY,\n        maxX = _a.maxX,\n        maxY = _a.maxY,\n        x = _a.x,\n        y = _a.y,\n        width = _a.width,\n        height = _a.height;\n\n    var finalX = x;\n    var finalY = y;\n\n    if (minX < regionMinX || maxX < regionMinX) {\n      // 超出左侧\n      finalX = regionMinX;\n    }\n\n    if (minY < regionMinY || maxY < regionMinY) {\n      // 超出顶部\n      finalY = regionMinY;\n    }\n\n    if (minX > regionMaxX) {\n      // 整体超出右侧\n      finalX = regionMaxX - width;\n    } else if (maxX > regionMaxX) {\n      // 超出右侧\n      finalX = finalX - (maxX - regionMaxX);\n    }\n\n    if (minY > regionMaxY) {\n      // 整体超出顶部\n      finalY = regionMaxY - height;\n    } else if (maxY > regionMaxY) {\n      // 超出底部\n      finalY = finalY - (maxY - regionMaxY);\n    }\n\n    if (finalX !== x || finalY !== y) {\n      translate(label, finalX - x, finalY - y);\n    }\n  });\n}","map":{"version":3,"mappings":"AAAA,SAASA,IAAT,QAAqB,YAArB;AAEA,SAASC,SAAT,QAA0B,yBAA1B;AAGA;;;;;;;AAMA,OAAM,SAAUC,aAAV,CAAwBC,KAAxB,EAA4CC,MAA5C,EAA8DC,MAA9D,EAA2FC,MAA3F,EAAuG;EAC3GN,IAAI,CAACI,MAAD,EAAS,UAACG,KAAD,EAAc;IACjB,IAAMC,UAAU,GAA2DF,MAAM,KAAjF;IAAA,IAAwBG,UAAU,GAAyCH,MAAM,KAAjF;IAAA,IAA0CI,UAAU,GAAuBJ,MAAM,KAAjF;IAAA,IAA4DK,UAAU,GAAKL,MAAM,KAAjF;;IACF,SAAkDC,KAAK,CAACK,aAAN,EAAlD;IAAA,IAAEC,IAAI,UAAN;IAAA,IAAQC,IAAI,UAAZ;IAAA,IAAcC,IAAI,UAAlB;IAAA,IAAoBC,IAAI,UAAxB;IAAA,IAA0BC,CAAC,OAA3B;IAAA,IAA6BC,CAAC,OAA9B;IAAA,IAAgCC,KAAK,WAArC;IAAA,IAAuCC,MAAM,YAA7C;;IAEN,IAAIC,MAAM,GAAGJ,CAAb;IACA,IAAIK,MAAM,GAAGJ,CAAb;;IACA,IAAIL,IAAI,GAAGL,UAAP,IAAqBO,IAAI,GAAGP,UAAhC,EAA4C;MAC1C;MACAa,MAAM,GAAGb,UAAT;IACD;;IACD,IAAIM,IAAI,GAAGL,UAAP,IAAqBO,IAAI,GAAGP,UAAhC,EAA4C;MAC1C;MACAa,MAAM,GAAGb,UAAT;IACD;;IAED,IAAII,IAAI,GAAGH,UAAX,EAAuB;MACrB;MACAW,MAAM,GAAGX,UAAU,GAAGS,KAAtB;IACD,CAHD,MAGO,IAAIJ,IAAI,GAAGL,UAAX,EAAuB;MAC5B;MACAW,MAAM,GAAGA,MAAM,IAAIN,IAAI,GAAGL,UAAX,CAAf;IACD;;IAED,IAAII,IAAI,GAAGH,UAAX,EAAuB;MACrB;MACAW,MAAM,GAAGX,UAAU,GAAGS,MAAtB;IACD,CAHD,MAGO,IAAIJ,IAAI,GAAGL,UAAX,EAAuB;MAC5B;MACAW,MAAM,GAAGA,MAAM,IAAIN,IAAI,GAAGL,UAAX,CAAf;IACD;;IAED,IAAIU,MAAM,KAAKJ,CAAX,IAAgBK,MAAM,KAAKJ,CAA/B,EAAkC;MAChCjB,SAAS,CAACM,KAAD,EAAQc,MAAM,GAAGJ,CAAjB,EAAoBK,MAAM,GAAGJ,CAA7B,CAAT;IACD;EACF,CAlCG,CAAJ;AAmCD","names":["each","translate","limitInCanvas","items","labels","shapes","region","label","regionMinX","regionMinY","regionMaxX","regionMaxY","getCanvasBBox","minX","minY","maxX","maxY","x","y","width","height","finalX","finalY"],"sourceRoot":"","sources":["../../../../src/geometry/label/layout/limit-in-canvas.ts"],"sourcesContent":["import { each } from '@antv/util';\nimport { BBox, IGroup, IShape } from '../../../dependents';\nimport { translate } from '../../../util/transform';\nimport { LabelItem } from '../interface';\n\n/**\n * @ignore\n * 将 label 限制在画布范围内，简单得将超出画布的 label 往画布内调整\n * @param labels\n * @param cfg\n */\nexport function limitInCanvas(items: LabelItem[], labels: IGroup[], shapes: IShape[] | IGroup[], region: BBox) {\n  each(labels, (label: IGroup) => {\n    const { minX: regionMinX, minY: regionMinY, maxX: regionMaxX, maxY: regionMaxY } = region;\n    const { minX, minY, maxX, maxY, x, y, width, height } = label.getCanvasBBox();\n\n    let finalX = x;\n    let finalY = y;\n    if (minX < regionMinX || maxX < regionMinX) {\n      // 超出左侧\n      finalX = regionMinX;\n    }\n    if (minY < regionMinY || maxY < regionMinY) {\n      // 超出顶部\n      finalY = regionMinY;\n    }\n\n    if (minX > regionMaxX) {\n      // 整体超出右侧\n      finalX = regionMaxX - width;\n    } else if (maxX > regionMaxX) {\n      // 超出右侧\n      finalX = finalX - (maxX - regionMaxX);\n    }\n\n    if (minY > regionMaxY) {\n      // 整体超出顶部\n      finalY = regionMaxY - height;\n    } else if (maxY > regionMaxY) {\n      // 超出底部\n      finalY = finalY - (maxY - regionMaxY);\n    }\n\n    if (finalX !== x || finalY !== y) {\n      translate(label, finalX - x, finalY - y);\n    }\n  });\n}\n"]},"metadata":{},"sourceType":"module"}