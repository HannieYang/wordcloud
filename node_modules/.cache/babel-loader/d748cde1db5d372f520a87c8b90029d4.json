{"ast":null,"code":"import { __assign } from \"tslib\";\nimport { get } from '@antv/util';\nimport { ellipsisLabel } from './label';\nimport { applyRotate, applyTranslate } from './matrix';\nimport { formatPadding } from './util';\nexport function renderTag(container, tagCfg) {\n  var x = tagCfg.x,\n      y = tagCfg.y,\n      content = tagCfg.content,\n      style = tagCfg.style,\n      id = tagCfg.id,\n      name = tagCfg.name,\n      rotate = tagCfg.rotate,\n      maxLength = tagCfg.maxLength,\n      autoEllipsis = tagCfg.autoEllipsis,\n      isVertical = tagCfg.isVertical,\n      ellipsisPosition = tagCfg.ellipsisPosition,\n      background = tagCfg.background;\n  var tagGroup = container.addGroup({\n    id: id + \"-group\",\n    name: name + \"-group\",\n    attrs: {\n      x: x,\n      y: y\n    }\n  }); // Text shape\n\n  var text = tagGroup.addShape({\n    type: 'text',\n    id: id,\n    name: name,\n    attrs: __assign({\n      x: 0,\n      y: 0,\n      text: content\n    }, style)\n  }); // maxLength 应包含 background 中的 padding 值\n\n  var padding = formatPadding(get(background, 'padding', 0));\n\n  if (maxLength && autoEllipsis) {\n    var maxTextLength = maxLength - (padding[1] + padding[3]); // 超出自动省略\n\n    ellipsisLabel(!isVertical, text, maxTextLength, ellipsisPosition);\n  }\n\n  if (background) {\n    // 渲染文本背景\n    var backgroundStyle = get(background, 'style', {});\n\n    var _a = text.getCanvasBBox(),\n        minX = _a.minX,\n        minY = _a.minY,\n        width = _a.width,\n        height = _a.height;\n\n    var tagBg = tagGroup.addShape('rect', {\n      id: id + \"-bg\",\n      name: id + \"-bg\",\n      attrs: __assign({\n        x: minX - padding[3],\n        y: minY - padding[0],\n        width: width + padding[1] + padding[3],\n        height: height + padding[0] + padding[2]\n      }, backgroundStyle)\n    });\n    tagBg.toBack();\n  }\n\n  applyTranslate(tagGroup, x, y);\n  applyRotate(tagGroup, rotate, x, y);\n}","map":{"version":3,"mappings":"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","names":["get","ellipsisLabel","applyRotate","applyTranslate","formatPadding","renderTag","container","tagCfg","y","content","style","id","name","rotate","maxLength","autoEllipsis","isVertical","ellipsisPosition","background","tagGroup","addGroup","attrs","x","text","addShape","type","padding","maxTextLength","backgroundStyle","getCanvasBBox","minX","minY","width","height","tagBg","toBack"],"sourceRoot":"","sources":["../../src/util/graphic.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}