{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { createDom, modifyCSS } from '@antv/dom-util';\nimport { substitute, hasKey } from '@antv/util';\nimport { toPx, getTextPoint } from '../util/util';\nimport HtmlComponent from '../abstract/html-component';\nimport * as CssConst from './css-const';\nimport HtmlTheme from './html-theme';\n\nvar HtmlCrosshair =\n/** @class */\nfunction (_super) {\n  __extends(HtmlCrosshair, _super);\n\n  function HtmlCrosshair() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  HtmlCrosshair.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n\n    return __assign(__assign({}, cfg), {\n      name: 'crosshair',\n      type: 'html',\n      locationType: 'region',\n      start: {\n        x: 0,\n        y: 0\n      },\n      end: {\n        x: 0,\n        y: 0\n      },\n      capture: false,\n      text: null,\n      containerTpl: \"<div class=\\\"\" + CssConst.CONTAINER_CLASS + \"\\\"></div>\",\n      crosshairTpl: \"<div class=\\\"\" + CssConst.CROSSHAIR_LINE + \"\\\"></div>\",\n      textTpl: \"<span class=\\\"\" + CssConst.CROSSHAIR_TEXT + \"\\\">{content}</span>\",\n      domStyles: null,\n      containerClassName: CssConst.CONTAINER_CLASS,\n      defaultStyles: HtmlTheme,\n      defaultCfg: {\n        text: {\n          position: 'start',\n          content: null,\n          align: 'center',\n          offset: 10\n        }\n      }\n    });\n  };\n\n  HtmlCrosshair.prototype.render = function () {\n    this.resetText();\n    this.resetPosition();\n  }; // 绘制 crosshair\n\n\n  HtmlCrosshair.prototype.initCrossHair = function () {\n    var container = this.getContainer();\n    var crosshairTpl = this.get('crosshairTpl');\n    var crosshairEl = createDom(crosshairTpl);\n    container.appendChild(crosshairEl);\n    this.applyStyle(CssConst.CROSSHAIR_LINE, crosshairEl);\n    this.set('crosshairEl', crosshairEl);\n  }; // 获取文本的位置\n\n\n  HtmlCrosshair.prototype.getTextPoint = function () {\n    var _a = this.getLocation(),\n        start = _a.start,\n        end = _a.end;\n\n    var _b = this.get('text'),\n        position = _b.position,\n        offset = _b.offset;\n\n    return getTextPoint(start, end, position, offset);\n  }; // 设置 text\n\n\n  HtmlCrosshair.prototype.resetText = function () {\n    var text = this.get('text');\n    var textEl = this.get('textEl');\n\n    if (text) {\n      var content = text.content;\n\n      if (!textEl) {\n        var container = this.getContainer();\n        var textTpl = substitute(this.get('textTpl'), text);\n        textEl = createDom(textTpl);\n        container.appendChild(textEl);\n        this.applyStyle(CssConst.CROSSHAIR_TEXT, textEl);\n        this.set('textEl', textEl);\n      }\n\n      textEl.innerHTML = content;\n    } else if (textEl) {\n      textEl.remove();\n    }\n  }; // 是否垂直\n\n\n  HtmlCrosshair.prototype.isVertical = function (start, end) {\n    return start.x === end.x;\n  }; // 重新调整位置\n\n\n  HtmlCrosshair.prototype.resetPosition = function () {\n    var crosshairEl = this.get('crosshairEl');\n\n    if (!crosshairEl) {\n      this.initCrossHair();\n      crosshairEl = this.get('crosshairEl');\n    }\n\n    var start = this.get('start');\n    var end = this.get('end');\n    var minX = Math.min(start.x, end.x);\n    var minY = Math.min(start.y, end.y);\n\n    if (this.isVertical(start, end)) {\n      modifyCSS(crosshairEl, {\n        width: '1px',\n        height: toPx(Math.abs(end.y - start.y))\n      });\n    } else {\n      modifyCSS(crosshairEl, {\n        height: '1px',\n        width: toPx(Math.abs(end.x - start.x))\n      });\n    }\n\n    modifyCSS(crosshairEl, {\n      top: toPx(minY),\n      left: toPx(minX)\n    });\n    this.alignText();\n  };\n\n  HtmlCrosshair.prototype.alignText = function () {\n    // 重新设置 text 位置\n    var textEl = this.get('textEl');\n\n    if (textEl) {\n      var align = this.get('text').align;\n      var clientWidth = textEl.clientWidth;\n      var point = this.getTextPoint();\n\n      switch (align) {\n        case 'center':\n          point.x = point.x - clientWidth / 2;\n          break;\n\n        case 'right':\n          point.x = point.x - clientWidth;\n\n        case 'left':\n          break;\n      }\n\n      modifyCSS(textEl, {\n        top: toPx(point.y),\n        left: toPx(point.x)\n      });\n    }\n  };\n\n  HtmlCrosshair.prototype.updateInner = function (cfg) {\n    if (hasKey(cfg, 'text')) {\n      this.resetText();\n    }\n\n    _super.prototype.updateInner.call(this, cfg);\n  };\n\n  return HtmlCrosshair;\n}(HtmlComponent);\n\nexport default HtmlCrosshair;","map":{"version":3,"mappings":"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","names":["createDom","modifyCSS","substitute","hasKey","toPx","getTextPoint","HtmlComponent","CssConst","HtmlTheme","__extends","HtmlCrosshair","cfg","_super","getDefaultCfg","call","name","type","locationType","start","x","y","end","capture","text","containerTpl","CONTAINER_CLASS","crosshairTpl","CROSSHAIR_LINE","textTpl","CROSSHAIR_TEXT","domStyles","containerClassName","defaultStyles","defaultCfg","position","content","align","offset","resetText","resetPosition","container","getContainer","get","crosshairEl","appendChild","applyStyle","set","getLocation","textEl","innerHTML","remove","initCrossHair","minX","Math","min","minY","isVertical","width","height","abs","top","left","alignText","clientWidth","point","updateInner"],"sourceRoot":"","sources":["../../src/crosshair/html.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}