{"ast":null,"code":"import { registerInteraction, registerAction } from '@antv/g2';\nimport { get, isArray } from '@antv/util';\nimport { DrillDownAction } from './actions/drill-down';\n/**\n * 判断是否为父节点\n */\n\nexport function isParentNode(context) {\n  var data = get(context, ['event', 'data', 'data'], {});\n  return isArray(data.children) && data.children.length > 0;\n}\n/**\n * 判断是否在中心\n */\n\nfunction inCenter(context) {\n  var coordinate = context.view.getCoordinate();\n  var innerRadius = coordinate.innerRadius;\n\n  if (innerRadius) {\n    var _a = context.event,\n        x = _a.x,\n        y = _a.y;\n    var _b = coordinate.center,\n        centerX = _b.x,\n        centerY = _b.y;\n    var r = coordinate.getRadius() * innerRadius;\n    var distance = Math.sqrt(Math.pow(centerX - x, 2) + Math.pow(centerY - y, 2));\n    return distance < r;\n  }\n\n  return false;\n}\n\nregisterAction('drill-down-action', DrillDownAction);\nregisterInteraction('drill-down', {\n  showEnable: [{\n    trigger: 'element:mouseenter',\n    action: 'cursor:pointer',\n    isEnable: isParentNode\n  }, {\n    trigger: 'element:mouseleave',\n    action: 'cursor:default'\n  }, // 中心处，肯定会触发 element:mouseleave 操作\n  {\n    trigger: 'element:mouseleave',\n    action: 'cursor:pointer',\n    isEnable: inCenter\n  }],\n  start: [{\n    trigger: 'element:click',\n    isEnable: isParentNode,\n    action: ['drill-down-action:click']\n  }, {\n    trigger: 'afterchangesize',\n    action: ['drill-down-action:resetPosition']\n  }, {\n    // 点击中心，返回上一层\n    trigger: 'click',\n    isEnable: inCenter,\n    action: ['drill-down-action:back']\n  }]\n});","map":{"version":3,"mappings":"AAAA,SAASA,mBAAT,EAA8BC,cAA9B,QAAoD,UAApD;AACA,SAASC,GAAT,EAAcC,OAAd,QAA6B,YAA7B;AACA,SAASC,eAAT,QAAgC,sBAAhC;AAEA;;;;AAGA,OAAM,SAAUC,YAAV,CAAuBC,OAAvB,EAA8B;EAClC,IAAMC,IAAI,GAAGL,GAAG,CAACI,OAAD,EAAU,CAAC,OAAD,EAAU,MAAV,EAAkB,MAAlB,CAAV,EAAqC,EAArC,CAAhB;EACA,OAAOH,OAAO,CAACI,IAAI,CAACC,QAAN,CAAP,IAA0BD,IAAI,CAACC,QAAL,CAAcC,MAAd,GAAuB,CAAxD;AACD;AAED;;;;AAGA,SAASC,QAAT,CAAkBJ,OAAlB,EAAyB;EACvB,IAAMK,UAAU,GAAGL,OAAO,CAACM,IAAR,CAAaC,aAAb,EAAnB;EACQ,eAAW,GAAKF,UAAU,YAA1B;;EACR,IAAIG,WAAJ,EAAiB;IACT,SAAWR,OAAO,CAACS,KAAnB;IAAA,IAAEC,CAAC,OAAH;IAAA,IAAKC,CAAC,OAAN;IACA,SAA6BN,UAAU,CAACO,MAAxC;IAAA,IAAKC,OAAO,OAAZ;IAAA,IAAiBC,OAAO,OAAxB;IACN,IAAMC,CAAC,GAAGV,UAAU,CAACW,SAAX,KAAyBR,WAAnC;IACA,IAAMS,QAAQ,GAAGC,IAAI,CAACC,IAAL,CAAUD,SAACL,OAAO,GAAGH,CAAX,EAAiB,CAAjB,IAAqBQ,SAACJ,OAAO,GAAGH,CAAX,EAAiB,CAAjB,CAA/B,CAAjB;IACA,OAAOM,QAAQ,GAAGF,CAAlB;EACD;;EACD,OAAO,KAAP;AACD;;AAEDpB,cAAc,CAAC,mBAAD,EAAsBG,eAAtB,CAAd;AACAJ,mBAAmB,CAAC,YAAD,EAAe;EAChC0B,UAAU,EAAE,CACV;IAAEC,OAAO,EAAE,oBAAX;IAAiCC,MAAM,EAAE,gBAAzC;IAA2DC,QAAQ,EAAExB;EAArE,CADU,EAEV;IAAEsB,OAAO,EAAE,oBAAX;IAAiCC,MAAM,EAAE;EAAzC,CAFU,EAGV;EACA;IAAED,OAAO,EAAE,oBAAX;IAAiCC,MAAM,EAAE,gBAAzC;IAA2DC,QAAQ,EAAEnB;EAArE,CAJU,CADoB;EAOhCoB,KAAK,EAAE,CACL;IACEH,OAAO,EAAE,eADX;IAEEE,QAAQ,EAAExB,YAFZ;IAGEuB,MAAM,EAAE,CAAC,yBAAD;EAHV,CADK,EAML;IACED,OAAO,EAAE,iBADX;IAEEC,MAAM,EAAE,CAAC,iCAAD;EAFV,CANK,EAUL;IACE;IACAD,OAAO,EAAE,OAFX;IAGEE,QAAQ,EAAEnB,QAHZ;IAIEkB,MAAM,EAAE,CAAC,wBAAD;EAJV,CAVK;AAPyB,CAAf,CAAnB","names":["registerInteraction","registerAction","get","isArray","DrillDownAction","isParentNode","context","data","children","length","inCenter","coordinate","view","getCoordinate","innerRadius","event","x","y","center","centerX","centerY","r","getRadius","distance","Math","sqrt","showEnable","trigger","action","isEnable","start"],"sourceRoot":"","sources":["../../src/interactions/drill-down.ts"],"sourcesContent":["import { registerInteraction, registerAction } from '@antv/g2';\nimport { get, isArray } from '@antv/util';\nimport { DrillDownAction } from './actions/drill-down';\n\n/**\n * 判断是否为父节点\n */\nexport function isParentNode(context) {\n  const data = get(context, ['event', 'data', 'data'], {});\n  return isArray(data.children) && data.children.length > 0;\n}\n\n/**\n * 判断是否在中心\n */\nfunction inCenter(context) {\n  const coordinate = context.view.getCoordinate();\n  const { innerRadius } = coordinate;\n  if (innerRadius) {\n    const { x, y } = context.event;\n    const { x: centerX, y: centerY } = coordinate.center;\n    const r = coordinate.getRadius() * innerRadius;\n    const distance = Math.sqrt((centerX - x) ** 2 + (centerY - y) ** 2);\n    return distance < r;\n  }\n  return false;\n}\n\nregisterAction('drill-down-action', DrillDownAction);\nregisterInteraction('drill-down', {\n  showEnable: [\n    { trigger: 'element:mouseenter', action: 'cursor:pointer', isEnable: isParentNode },\n    { trigger: 'element:mouseleave', action: 'cursor:default' },\n    // 中心处，肯定会触发 element:mouseleave 操作\n    { trigger: 'element:mouseleave', action: 'cursor:pointer', isEnable: inCenter },\n  ],\n  start: [\n    {\n      trigger: 'element:click',\n      isEnable: isParentNode,\n      action: ['drill-down-action:click'],\n    },\n    {\n      trigger: 'afterchangesize',\n      action: ['drill-down-action:resetPosition'],\n    },\n    {\n      // 点击中心，返回上一层\n      trigger: 'click',\n      isEnable: inCenter,\n      action: ['drill-down-action:back'],\n    },\n  ],\n});\n"]},"metadata":{},"sourceType":"module"}