{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { createDom, modifyCSS } from '@antv/dom-util';\nimport { isNil, isString, deepMix, each, hasKey } from '@antv/util';\nimport { clearDom, createBBox, hasClass } from '../util/util';\nimport Component from './component';\n\nvar HtmlComponent =\n/** @class */\nfunction (_super) {\n  __extends(HtmlComponent, _super);\n\n  function HtmlComponent() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  HtmlComponent.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n\n    return __assign(__assign({}, cfg), {\n      container: null,\n      containerTpl: '<div></div>',\n      updateAutoRender: true,\n      containerClassName: '',\n      parent: null\n    });\n  };\n\n  HtmlComponent.prototype.getContainer = function () {\n    return this.get('container');\n  };\n  /**\n   * 显示组件\n   */\n\n\n  HtmlComponent.prototype.show = function () {\n    var container = this.get('container');\n    container.style.display = '';\n    this.set('visible', true);\n  };\n  /**\n   * 隐藏组件\n   */\n\n\n  HtmlComponent.prototype.hide = function () {\n    var container = this.get('container');\n    container.style.display = 'none';\n    this.set('visible', false);\n  };\n  /**\n   * 是否允许捕捉事件\n   * @param capture 事件捕捉\n   */\n\n\n  HtmlComponent.prototype.setCapture = function (capture) {\n    var container = this.getContainer();\n    var value = capture ? 'auto' : 'none';\n    container.style.pointerEvents = value;\n    this.set('capture', capture);\n  };\n\n  HtmlComponent.prototype.getBBox = function () {\n    var container = this.getContainer();\n    var x = parseFloat(container.style.left) || 0;\n    var y = parseFloat(container.style.top) || 0;\n    return createBBox(x, y, container.clientWidth, container.clientHeight);\n  };\n\n  HtmlComponent.prototype.clear = function () {\n    var container = this.get('container');\n    clearDom(container);\n  };\n\n  HtmlComponent.prototype.destroy = function () {\n    this.removeEvent();\n    this.removeDom();\n\n    _super.prototype.destroy.call(this);\n  };\n  /**\n   * 复写 init，主要是初始化 DOM 和事件\n   */\n\n\n  HtmlComponent.prototype.init = function () {\n    _super.prototype.init.call(this);\n\n    this.initContainer();\n    this.initDom();\n    this.resetStyles(); // 初始化样式\n\n    this.applyStyles(); // 应用样式\n\n    this.initEvent();\n    this.initCapture();\n    this.initVisible();\n  };\n\n  HtmlComponent.prototype.initCapture = function () {\n    this.setCapture(this.get('capture'));\n  };\n\n  HtmlComponent.prototype.initVisible = function () {\n    if (!this.get('visible')) {\n      // 设置初始显示状态\n      this.hide();\n    } else {\n      this.show();\n    }\n  };\n\n  HtmlComponent.prototype.initDom = function () {};\n\n  HtmlComponent.prototype.initContainer = function () {\n    var container = this.get('container');\n\n    if (isNil(container)) {\n      // 未指定 container 则创建\n      container = this.createDom();\n      var parent_1 = this.get('parent');\n\n      if (isString(parent_1)) {\n        parent_1 = document.getElementById(parent_1);\n        this.set('parent', parent_1);\n      }\n\n      parent_1.appendChild(container);\n\n      if (this.get('containerId')) {\n        container.setAttribute('id', this.get('containerId'));\n      }\n\n      this.set('container', container);\n    } else if (isString(container)) {\n      // 用户传入的 id, 作为 container\n      container = document.getElementById(container);\n      this.set('container', container);\n    } // else container 是 DOM\n\n\n    if (!this.get('parent')) {\n      this.set('parent', container.parentNode);\n    }\n  }; // 样式需要进行合并，不能单纯的替换，否则使用非常不方便\n\n\n  HtmlComponent.prototype.resetStyles = function () {\n    var style = this.get('domStyles');\n    var defaultStyles = this.get('defaultStyles');\n\n    if (!style) {\n      style = defaultStyles;\n    } else {\n      style = deepMix({}, defaultStyles, style);\n    }\n\n    this.set('domStyles', style);\n  }; // 应用所有的样式\n\n\n  HtmlComponent.prototype.applyStyles = function () {\n    var domStyles = this.get('domStyles');\n\n    if (!domStyles) {\n      return;\n    }\n\n    var container = this.getContainer();\n    this.applyChildrenStyles(container, domStyles);\n    var containerClassName = this.get('containerClassName');\n\n    if (containerClassName && hasClass(container, containerClassName)) {\n      var containerCss = domStyles[containerClassName];\n      modifyCSS(container, containerCss);\n    }\n  };\n\n  HtmlComponent.prototype.applyChildrenStyles = function (element, styles) {\n    each(styles, function (style, name) {\n      var elements = element.getElementsByClassName(name);\n      each(elements, function (el) {\n        modifyCSS(el, style);\n      });\n    });\n  }; // 应用到单个 DOM\n\n\n  HtmlComponent.prototype.applyStyle = function (cssName, dom) {\n    var domStyles = this.get('domStyles');\n    modifyCSS(dom, domStyles[cssName]);\n  };\n  /**\n   * @protected\n   */\n\n\n  HtmlComponent.prototype.createDom = function () {\n    var containerTpl = this.get('containerTpl');\n    return createDom(containerTpl);\n  };\n  /**\n   * @protected\n   * 初始化事件\n   */\n\n\n  HtmlComponent.prototype.initEvent = function () {};\n  /**\n   * @protected\n   * 清理 DOM\n   */\n\n\n  HtmlComponent.prototype.removeDom = function () {\n    var container = this.get('container'); // 节点不一定有parentNode\n\n    container && container.parentNode && container.parentNode.removeChild(container);\n  };\n  /**\n   * @protected\n   * 清理事件\n   */\n\n\n  HtmlComponent.prototype.removeEvent = function () {};\n\n  HtmlComponent.prototype.updateInner = function (cfg) {\n    // 更新样式\n    if (hasKey(cfg, 'domStyles')) {\n      this.resetStyles();\n      this.applyStyles();\n    } // 只要属性发生变化，都调整一些位置\n\n\n    this.resetPosition();\n  };\n\n  HtmlComponent.prototype.resetPosition = function () {};\n\n  ;\n  return HtmlComponent;\n}(Component);\n\nexport default HtmlComponent;","map":{"version":3,"mappings":"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","names":["createDom","modifyCSS","isNil","isString","deepMix","each","hasKey","clearDom","createBBox","hasClass","Component","__extends","HtmlComponent","cfg","_super","getDefaultCfg","call","container","containerTpl","updateAutoRender","containerClassName","parent","get","style","display","set","capture","getContainer","value","pointerEvents","x","parseFloat","left","y","top","clientWidth","clientHeight","removeEvent","removeDom","destroy","init","initContainer","initDom","resetStyles","applyStyles","initEvent","initCapture","initVisible","setCapture","hide","show","parent_1","document","getElementById","appendChild","setAttribute","parentNode","defaultStyles","domStyles","applyChildrenStyles","containerCss","element","styles","name","elements","getElementsByClassName","el","cssName","dom","removeChild","resetPosition"],"sourceRoot":"","sources":["../../src/abstract/html-component.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}